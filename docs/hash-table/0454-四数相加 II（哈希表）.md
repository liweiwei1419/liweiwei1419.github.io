第 454 题：四数相加 II（乘法的思路没说清楚）

链接：[454. 四数相加 II](https://leetcode-cn.com/problems/4sum-ii/)



知识点：哈希表。



思路分析：其实思路只要清楚了，是个很简单的问题。

把 A、B、C、D 分成两组，在 A、B 之和中找与 C、D 的相反数之和相同的组合数，要使用哈希表这个数据结构。考察了组合数，乘法计数原理。代码编写有一定技巧。



方法一：用加法

用加法，下面这种写法省下一个 map，不过在计算的时候，就不能用乘法了，只能用加法，就这点区别。

```java
import java.util.HashMap;
import java.util.Map;

public class Solution {

    public int fourSumCount(int[] A, int[] B, int[] C, int[] D) {
        // key 是 A 和 B 数组分别取一个数可能的和，value 是这个和可能由几个不同的组合
        Map<Integer, Integer> map = new HashMap<>();
        // 第 1 步：把 A 和 B 所有的组合存入哈希表
        for (int a : A) {
            for (int b : B) {
                int sum = a + b;
                map.put(sum , map.getOrDefault(sum, 0) + 1);
            }
        }

        // 第 2 步：计算 C 和 D 的所有组合的相反数
        // 计数器
        int count = 0;
        for (int c : C) {
            for (int d : D) {
                int target = -c - d;
                if (map.containsKey(target)) {
                    count += map.get(target);
                }
            }
        }
        return count;
    }
}
```



```python
from typing import List


class Solution:
    def fourSumCount(self, A: List[int], B: List[int], C: List[int], D: List[int]) -> int:
        map = dict()
        for num3 in C:
            for num4 in D:
                map[num3 + num4] = (map.setdefault(num3 + num4, 0) + 1)

        res = 0

        for num1 in A:
            for num2 in B:
                s = num1 + num2
                if -s in map:
                    res += map[-s]
        return res
```



方法二：用乘法





```python
from typing import List


class Solution:
    def fourSumCount(self, A: List[int], B: List[int], C: List[int], D: List[int]) -> int:
        map1 = self.__get_map(A, B)
        map2 = self.__get_map(C, D)
        res = 0

        for key1 in map1:
            if -key1 in map2:
                res += map1[key1] * map2[-key1]
        return res

    def __get_map(self, tuple1, tuple2):
        map = dict()
        for num1 in tuple1:
            for num2 in tuple2:
                map[num1 + num2] = (map.setdefault(num1 + num2, 0) + 1)
        return map
```